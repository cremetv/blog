"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",t):"object"==("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=t():e.EvEmitter=t()}("undefined"!=typeof window?window:void 0,function(){function e(){}var t=e.prototype;return t.on=function(e,t){if(e&&t){var n=this._events=this._events||{},o=n[e]=n[e]||[];return-1==o.indexOf(t)&&o.push(t),this}},t.once=function(e,t){if(e&&t){this.on(e,t);var n=this._onceEvents=this._onceEvents||{};return(n[e]=n[e]||{})[t]=!0,this}},t.off=function(e,t){var n=this._events&&this._events[e];if(n&&n.length){var o=n.indexOf(t);return-1!=o&&n.splice(o,1),this}},t.emitEvent=function(e,t){var n=this._events&&this._events[e];if(n&&n.length){n=n.slice(0),t=t||[];for(var o=this._onceEvents&&this._onceEvents[e],i=0;i<n.length;i++){var s=n[i];o&&o[s]&&(this.off(e,s),delete o[s]),s.apply(this,t)}return this}},t.allOff=function(){delete this._events,delete this._onceEvents},e}),function(t,n){"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(e){return n(t,e)}):"object"==("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=n(t,require("ev-emitter")):t.imagesLoaded=n(t,t.EvEmitter)}("undefined"!=typeof window?window:void 0,function(t,e){function s(e,t){for(var n in t)e[n]=t[n];return e}function r(e,t,n){if(!(this instanceof r))return new r(e,t,n);var o,i=e;("string"==typeof e&&(i=document.querySelectorAll(e)),i)?(this.elements=(o=i,Array.isArray(o)?o:"object"==(void 0===o?"undefined":_typeof(o))&&"number"==typeof o.length?c.call(o):[o]),this.options=s({},this.options),"function"==typeof t?n=t:s(this.options,t),n&&this.on("always",n),this.getImages(),a&&(this.jqDeferred=new a.Deferred),setTimeout(this.check.bind(this))):d.error("Bad element for imagesLoaded "+(i||e))}function n(e){this.img=e}function o(e,t){this.url=e,this.element=t,this.img=new Image}var a=t.jQuery,d=t.console,c=Array.prototype.slice;r.prototype=Object.create(e.prototype),r.prototype.options={},r.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},r.prototype.addElementImages=function(e){"IMG"==e.nodeName&&this.addImage(e),!0===this.options.background&&this.addElementBackgroundImages(e);var t=e.nodeType;if(t&&h[t]){for(var n=e.querySelectorAll("img"),o=0;o<n.length;o++){var i=n[o];this.addImage(i)}if("string"==typeof this.options.background){var s=e.querySelectorAll(this.options.background);for(o=0;o<s.length;o++){var r=s[o];this.addElementBackgroundImages(r)}}}};var h={1:!0,9:!0,11:!0};return r.prototype.addElementBackgroundImages=function(e){var t=getComputedStyle(e);if(t)for(var n=/url\((['"])?(.*?)\1\)/gi,o=n.exec(t.backgroundImage);null!==o;){var i=o&&o[2];i&&this.addBackground(i,e),o=n.exec(t.backgroundImage)}},r.prototype.addImage=function(e){var t=new n(e);this.images.push(t)},r.prototype.addBackground=function(e,t){var n=new o(e,t);this.images.push(n)},r.prototype.check=function(){function t(e,t,n){setTimeout(function(){o.progress(e,t,n)})}var o=this;this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?this.images.forEach(function(e){e.once("progress",t),e.check()}):this.complete()},r.prototype.progress=function(e,t,n){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded,this.emitEvent("progress",[this,e,t]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,e),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&d&&d.log("progress: "+n,e,t)},r.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(e,[this]),this.emitEvent("always",[this]),this.jqDeferred){var t=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[t](this)}},n.prototype=Object.create(e.prototype),n.prototype.check=function(){this.getIsImageComplete()?this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.proxyImage.src=this.img.src)},n.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth},n.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.img,t])},n.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},n.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},n.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},n.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},o.prototype=Object.create(n.prototype),o.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url,this.getIsImageComplete()&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},o.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},o.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.element,t])},r.makeJQueryPlugin=function(e){(e=e||t.jQuery)&&((a=e).fn.imagesLoaded=function(e,t){return new r(this,e,t).jqDeferred.promise(a(this))})},r.makeJQueryPlugin(),r});var barbaWrap=document.querySelectorAll(".barba-container")[0];window.onload=function(){parallax(),initMenu(),console.log("sw!!")};var getToken=function(){return new Promise(function(t,n){var e=new XMLHttpRequest;e.open("POST","../instagram.json",!0),e.setRequestHeader("Content-Type","application/json;charset=UTF-8"),e.addEventListener("load",function(){var e=JSON.parse(this.response);e.accessToken?t(e.accessToken):n("error")}),e.send()})},getInstaFeed=function(e){var t="https://api.instagram.com/v1/users/self/media/recent/?access_token="+e,n=new XMLHttpRequest;n.open("GET",t,!0),n.withCredentials=!0,n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.setRequestHeader("Access-Control-Allow-Origin","*"),n.addEventListener("load",function(){var e=JSON.parse(this.repsone);if(console.log(e),e){var t=e.data,i=0;t.reverse().forEach(function(e){if(!(5<=i)){var t=e.caption.text,n=e.link,o=e.images.standard_resolution.url;console.log(t),console.log(n),console.log(o),i++}})}}),n.send()};document.addEventListener("DOMContentLoaded",function(){getToken().then(function(e){getInstaFeed(e)},function(e){console.log("error: "+e)})});var initMenu=function(){console.log("init menu");var e=!1,t=document.querySelector("html"),n=document.querySelectorAll(".burger")[0],o=document.querySelectorAll(".main-menu")[0];n.addEventListener("click",function(){e?(e=!1,n.classList.remove("open"),o.classList.remove("open"),t.classList.remove("overflow"),TweenMax.to(o,1,{x:"100vw",ease:Power4.easeOut})):(e=!0,n.classList.add("open"),o.classList.add("open"),t.classList.add("overflow"),TweenMax.to(o,1,{x:0,ease:Power4.easeOut}))}),window.addEventListener("resize",function(){960<window.innerWidth?TweenMax.to(o,1,{x:0,ease:Power4.easeOut}):window.innerWidth<960&&!e&&TweenMax.to(o,1,{x:"100vw",ease:Power4.easeOut})})},parallax=function(){var t=document.querySelectorAll(".intro"),n=document.querySelectorAll(".sidebar")[0],o=n.offsetTop,i=document.querySelectorAll(".main-menu")[0],a=document.querySelectorAll(".main-footer")[0];t.forEach(function(e){var t=e.getElementsByTagName("img")[0],n=e.offsetHeight,o=e.offsetTop,i=(0-o)/n*n/2;TweenMax.set(t,{y:i+"px"})}),window.addEventListener("scroll",function(e){var s=window.scrollY,r=s+window.innerHeight;t.forEach(function(e){var t=e.getElementsByTagName("img")[0],n=e.offsetHeight,o=e.offsetTop;if(o<=r&&s<=o+n){var i=(s-o)/n*n/2;TweenMax.to(t,0,{y:i+"px",ease:Power0.easeNone})}}),960<window.innerWidth&&(s<o-i.offsetHeight-40?TweenMax.to(n,0,{y:0,ease:Power0.easeNone}):s>=o-i.offsetHeight-40&&s<document.body.offsetHeight-a.offsetHeight-n.offsetHeight-i.offsetHeight-80&&TweenMax.to(n,0,{y:s-(o-i.offsetHeight-40),ease:Power0.easeNone}))})},sidebar=document.querySelectorAll(".sidebar")[0];